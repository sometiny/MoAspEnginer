exports.lib.Cipher||(function(d){var m=exports;var w=m.lib;var i=w.Base;var t=w.WordArray;var v=w.BufferedBlockAlgorithm;var r=m.enc;var f=r.Utf8;var l=r.Base64;var b=m.algo;var h=b.EvpKDF;var j=w.Cipher=v.extend({cfg:i.extend(),createEncryptor:function(B,A){return this.create(this._ENC_XFORM_MODE,B,A)},createDecryptor:function(B,A){return this.create(this._DEC_XFORM_MODE,B,A)},init:function(C,B,A){this.cfg=this.cfg.extend(A);this._xformMode=C;this._key=B;this.reset()},reset:function(){v.reset.call(this);this._doReset()},process:function(A){this._append(A);return this._process()},finalize:function(B){if(B){this._append(B)}var A=this._doFinalize();return A},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:(function(){function A(B){if(typeof B=="string"){return g}else{return z}}return function(B){return{encrypt:function(E,D,C){return A(D).encrypt(B,E,D,C)},decrypt:function(E,D,C){return A(D).decrypt(B,E,D,C)}}}}())});var p=w.StreamCipher=j.extend({_doFinalize:function(){var A=this._process(!!"flush");return A},blockSize:1});var s=m.mode={};var y=w.BlockCipherMode=i.extend({createEncryptor:function(A,B){return this.Encryptor.create(A,B)},createDecryptor:function(A,B){return this.Decryptor.create(A,B)},init:function(A,B){this._cipher=A;this._iv=B}});var c=s.CBC=(function(){var A=y.extend();A.Encryptor=A.extend({processBlock:function(F,E){var C=this._cipher;var D=C.blockSize;B.call(this,F,E,D);C.encryptBlock(F,E);this._prevBlock=F.slice(E,E+D)}});A.Decryptor=A.extend({processBlock:function(G,F){var C=this._cipher;var E=C.blockSize;var D=G.slice(F,F+E);C.decryptBlock(G,F);B.call(this,G,F,E);this._prevBlock=D}});function B(H,G,E){var C=this._iv;if(C){var F=C;this._iv=d}else{var F=this._prevBlock}for(var D=0;D<E;D++){H[G+D]^=F[D]}}return A}());var e=m.pad={};var a=e.Pkcs7={pad:function(F,D){var E=D*4;var H=E-F.sigBytes%E;var A=(H<<24)|(H<<16)|(H<<8)|H;var C=[];for(var B=0;B<H;B+=4){C.push(A)}var G=t.create(C,H);F.concat(G)},unpad:function(A){var B=A.words[(A.sigBytes-1)>>>2]&255;A.sigBytes-=B}};var q=w.BlockCipher=j.extend({cfg:j.cfg.extend({mode:c,padding:a}),reset:function(){j.reset.call(this);var A=this.cfg;var B=A.iv;var D=A.mode;if(this._xformMode==this._ENC_XFORM_MODE){var C=D.createEncryptor}else{var C=D.createDecryptor;this._minBufferSize=1}this._mode=C.call(D,this,B&&B.words)},_doProcessBlock:function(B,A){this._mode.processBlock(B,A)},_doFinalize:function(){var B=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){B.pad(this._data,this.blockSize);var A=this._process(!!"flush")}else{var A=this._process(!!"flush");B.unpad(A)}return A},blockSize:128/32});var o=w.CipherParams=i.extend({init:function(A){this.mixIn(A)},toString:function(A){return(A||this.formatter).stringify(this)}});var n=m.format={};var u=n.OpenSSL={stringify:function(A){var D=A.ciphertext;var B=A.salt;if(B){var C=t.create([1398893684,1701076831]).concat(B).concat(D)}else{var C=D}return C.toString(l)},parse:function(C){var B=l.parse(C);var D=B.words;if(D[0]==1398893684&&D[1]==1701076831){var A=t.create(D.slice(2,4));D.splice(0,4);B.sigBytes-=16}return o.create({ciphertext:B,salt:A})}};var z=w.SerializableCipher=i.extend({cfg:i.extend({format:u}),encrypt:function(A,F,D,B){B=this.cfg.extend(B);var C=A.createEncryptor(D,B);var G=C.finalize(F);var E=C.cfg;return o.create({ciphertext:G,key:D,iv:E.iv,algorithm:A,mode:E.mode,padding:E.padding,blockSize:A.blockSize,formatter:B.format})},decrypt:function(A,E,C,B){B=this.cfg.extend(B);E=this._parse(E,B.format);var D=A.createDecryptor(C,B).finalize(E.ciphertext);return D},_parse:function(A,B){if(typeof A=="string"){return B.parse(A,this)}else{return A}}});var k=m.kdf={};var x=k.OpenSSL={execute:function(C,F,A,E){if(!E){E=t.random(64/8)}var D=h.create({keySize:F+A}).compute(C,E);var B=t.create(D.words.slice(F),A*4);D.sigBytes=F*4;return o.create({key:D,iv:B,salt:E})}};var g=w.PasswordBasedCipher=z.extend({cfg:z.cfg.extend({kdf:x}),encrypt:function(A,D,C,B){B=this.cfg.extend(B);var F=B.kdf.execute(C,A.keySize,A.ivSize);B.iv=F.iv;var E=z.encrypt.call(this,A,D,F.key,B);E.mixIn(F);return E},decrypt:function(A,E,C,B){B=this.cfg.extend(B);E=this._parse(E,B.format);var F=B.kdf.execute(C,A.keySize,A.ivSize,E.salt);B.iv=F.iv;var D=z.decrypt.call(this,A,E,F.key,B);return D}})}());